<!DOCTYPE html>
 <html>
   <head>
     <!--Import Google Icon Font-->
     <link href="https://fonts.googleapis.com/icon?family=Material+Icons" rel="stylesheet">
     <!--Import materialize.css-->
     <link rel="stylesheet" href="https://cdnjs.cloudflare.com/ajax/libs/materialize/1.0.0/css/materialize.min.css">

     <!--Let browser know website is optimized for mobile-->
     <meta name="viewport" content="width=device-width, initial-scale=1.0"/>
     <style>
       .datepicker-day-button{
    color: black;
  }</style>
   </head>

   <body>
     <div class="container">
    <div class="row">
        <div class="col s12  infobox center">
          <div class="col s12">
            <h1>OceansMap Dubai Scraper</h1>
            <h4>Example Demo</h4>
          </div>
            <div class="col s6">
                <div class="card grey darken-3">
                    <div class="card-content white-text">
                        <span class="card-title">Location</span>
                        <div class="input-field col s12">
                          <select>
                            <option value="" disabled selected>Choose your option</option>
                            <option value="32">Option 1</option>
                            <option value="31">Option 2</option>
                            <option value="30">Option 3</option>
                          </select>
                          <label>Materialize Select</label>
                        </div>
                    </div>
                </div>
            </div>
            <div class="col s6">
                <div class="card grey darken-3">
                    <div class="card-content white-text">
                        <span class="card-title">Date</span><br>
                        <input style="color:white;" id="dateValue" type="text" class="datepicker">
                    </div>
                </div>
            </div>
        </div>
        <div class="col s12 center">
          <a class="waves-effect waves-light btn-large" onclick="loadData()">Scrape!</a>
        </div>
          <div id ="dataHolder" class="col s12  data center">

            </div>
    </div>
</div>
     <!--JavaScript at end of body for optimized loading-->
     <script src="https://cdnjs.cloudflare.com/ajax/libs/materialize/1.0.0/js/materialize.min.js"></script>
     <script src="https://code.jquery.com/jquery-3.1.1.min.js" crossorigin="anonymous"></script>
      <script>
        function loadData(random) {
          let date = $("#dateValue").val();
          $.getJSON( " http://a5b.herokuapp.com/scrape?station=32&date=" + date, function( data ) {
            var items = [];
            $.each( data, function( key, val ) {
              console.log("key: " + key + " --- val: " + JSON.stringify(val.Variations))
              items.push( "<li id='" + key + "'>" + val.ParameterName + " - " + val.Variations[0].ObsValue + val.UnitAbbreviation +  "</li>" );
            });
            $("#dataHolder").html('');

            $( "<ul/>", {
              "class": "my-new-list",
              html: items.join( "" )
            }).appendTo( "#dataHolder" );
          });
          console.log( "ready!" );
        }
        document.addEventListener('DOMContentLoaded', function() {
            var elems = document.querySelectorAll('.datepicker');
            let options = {
              format : "yyyy-mm-dd",
              maxDate : Date.now()
            }
            var instances = M.Datepicker.init(elems, options);
            var elems = document.querySelectorAll('select');
            var instances = M.FormSelect.init(elems, {onSelect : loadData});
    });
     </script>

   </body>
 </html>
